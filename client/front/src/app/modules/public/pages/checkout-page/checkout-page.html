
<div class="page-container">
    <header class="page-header">
      <h1>Checkout</h1>
      <p>Please fill in your shipping details to complete your order.</p>
    </header>
  
    <div *ngIf="cart" class="checkout-layout">
      <!-- Left Column: Shipping & Payment -->
      <div class="form-section">
        <form [formGroup]="checkoutForm" (ngSubmit)="onSubmit()">
          
          <h3>Shipping Address</h3>
          <div class="form-grid">
            <div class="form-group full-width">
              <label for="street">Street Address *</label>
              <input id="street" type="text" formControlName="street" placeholder="Enter your street address">
              <small *ngIf="f['street'].invalid && f['street'].touched" class="error">Street is required.</small>
            </div>
            <div class="form-group">
              <label for="city">City *</label>
              <input id="city" type="text" formControlName="city" placeholder="Enter your city">
              <small *ngIf="f['city'].invalid && f['city'].touched" class="error">City is required.</small>
            </div>
            <div class="form-group">
              <label for="area">Area *</label>
              <input id="area" type="text" formControlName="area" placeholder="Enter your area">
              <small *ngIf="f['area'].invalid && f['area'].touched" class="error">Area is required.</small>
            </div>
            <div class="form-group">
              <label for="building">Building *</label>
              <input id="building" type="text" formControlName="building" placeholder="Building number/name">
              <small *ngIf="f['building'].invalid && f['building'].touched" class="error">Building is required.</small>
            </div>
            <div class="form-group">
              <label for="apartment">Apartment *</label>
              <input id="apartment" type="text" formControlName="apartment" placeholder="Apartment/unit number">
              <small *ngIf="f['apartment'].invalid && f['apartment'].touched" class="error">Apartment is required.</small>
            </div>
            <div class="form-group full-width">
              <label for="notes">Special Instructions (Optional)</label>
              <textarea id="notes" formControlName="notes" placeholder="Any special delivery instructions..." rows="3"></textarea>
            </div>
          </div>
  
          <h3 class="section-title">Payment Method</h3>
          <div class="payment-options">
            <label class="payment-option">
              <input type="radio" formControlName="paymentMethod" value="cod">
              <span class="payment-icon">ðŸ’µ</span>
              <div class="payment-details">
                <strong>Cash on Delivery</strong>
                <small>Pay when your order arrives</small>
              </div>
            </label>
            <!-- Future payment methods can be added here -->
            <!-- 
            <label class="payment-option">
              <input type="radio" formControlName="paymentMethod" value="credit_card">
              <span class="payment-icon">ðŸ’³</span>
              <div class="payment-details">
                <strong>Credit Card</strong>
                <small>Secure online payment</small>
              </div>
            </label>
            -->
          </div>
  
        </form>
      </div>
  
      <!-- Right Column: Order Summary -->
      <div class="order-summary">
        <h3>Your Order</h3>
        <div class="summary-items">
          <div class="summary-item" *ngFor="let item of cart.items">
            <div class="item-info">
              <span class="item-name">{{ item.title }}</span>
              <span class="item-quantity">x{{ item.quantity }}</span>
            </div>
            <span class="item-price">{{ item.price * item.quantity }} EGP</span>
          </div>
        </div>
        
        <div class="summary-breakdown">
          <div class="summary-row">
            <span>Subtotal</span>
            <span>{{ cart.totalPrice }} EGP</span>
          </div>
          <div class="summary-row">
            <span>Shipping</span>
            <span>FREE</span>
          </div>
        </div>
        
        <div class="summary-total">
          <span>Total</span>
          <span>{{ cart.totalPrice }} EGP</span>
        </div>
        
        <button type="submit" (click)="onSubmit()" class="checkout-btn" [disabled]="isLoading || !checkoutForm.valid">
          <span *ngIf="!isLoading">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M9 12l2 2 4-4"/>
              <path d="M21 12c0 4.97-4.03 9-9 9s-9-4.03-9-9 4.03-9 9-9 9 4.03 9 9z"/>
            </svg>
            Place Order
          </span>
          <span *ngIf="isLoading">
            <svg class="animate-spin" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 12a9 9 0 11-6.219-8.56"/>
            </svg>
            Placing Order...
          </span>
        </button>
        
        <div *ngIf="errorMessage" class="error-message">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <path d="M15 9l-6 6"/>
            <path d="M9 9l6 6"/>
          </svg>
          {{ errorMessage }}
        </div>
        
        <div class="security-notice">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
            <circle cx="12" cy="16" r="1"/>
            <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
          </svg>
          <span>Your order information is secure and encrypted</span>
        </div>
      </div>
    </div>
  
    <div *ngIf="!cart" class="state-container">
      <div class="empty-cart-notice">
        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="9" cy="21" r="1"/>
          <circle cx="20" cy="21" r="1"/>
          <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/>
        </svg>
        <h3>Your cart is empty</h3>
        <p>You cannot proceed to checkout with an empty cart.</p>
        <a routerLink="/products" class="continue-shopping-btn">Continue Shopping</a>
      </div>
    </div>
</div>
